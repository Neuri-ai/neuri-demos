(()=>{"use strict";var t=function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function r(t){try{c(o.next(t))}catch(t){s(t)}}function a(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((o=o.apply(t,e||[])).next())}))};class e extends HTMLElement{constructor(){super(),this.shadowDOM=this.attachShadow({mode:"open"})}connectedCallback(){this.mapComponentAttributes(),this.render(),this.initComponent()}mapComponentAttributes(){["text"].forEach((t=>{this.attributes[t]||(this.attributes[t]={value:"To use voice input, we needs access to your microphone. Check your browser preferences to allow microphone access and reload the page."})}))}render(){this.shadowDOM.innerHTML=`\n\t\t\t${this.templateCss()}\n\t\t\t${this.template()}\n\t\t`}checkMicrophone(){return t(this,void 0,void 0,(function*(){return navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then((t=>!0)).catch((t=>(this.$root.style.display="inherit",!1)))}))}checkBrowser(){const t=window.webkitSpeechRecognition||window.SpeechRecognition;try{return new t,!0}catch(t){return this.$root.style.display="inherit",this.$modalDOMTitle.innerHTML="Unsupported browser",this.$modalDOMMessage.innerHTML="To enable the SpeechRecognition in Firefox Nightly > 72, go to about:config and switch the flags media.webspeech.recognition.enable and media.webspeech.recognition.force_enable to true.",!1}}initComponent(){return t(this,void 0,void 0,(function*(){let t;this.$root=this.shadowDOM.querySelector(".permission-modal"),this.$modalDOMMessage=this.shadowDOM.querySelector(".permission-modal-message"),this.$modalDOMTitle=this.shadowDOM.querySelector(".permission-modal-title");let e=this.shadowDOM.getElementById("permission-allow");const n=yield this.checkMicrophone();n&&(t=this.checkBrowser()),n&&t&&(this.$root.style.display="none"),e.onclick=()=>{setTimeout((()=>{window.location.reload()}),500)}}))}disconnectedCallback(){this.remove()}templateCss(){return"\n\t\t<style>\n\t\t\t.permission-modal{\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tbox-shadow: 0 0 1rem 0 rgb(0 0 0 / 20%);\n\t\t\t\tbackground-color: rgba(0, 0, 0, .50);\n\t\t\t\tbackdrop-filter: blur(3px);\n\t\t\t\tz-index: 9999;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.permission-modal-content{\n\t\t\t\tmax-width: 400px;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 44%;\n\t\t\t\tleft: 50%;\n\t\t\t\ttransform: translate(-44%, -50%);\n\t\t\t}\n\t\t\t.permission-modal-header{\n\t\t\t\tcolor: #fff;\n\t\t\t\tfont-family: 'Poppins', sans-serif;\n\t\t\t}\n\t\t\t.permission-modal-header>h2{\n\t\t\t\tfont-size: 1.5rem;\n\t\t\t\tfont-weight: 600;\n\t\t\t\tmargin-bottom: 1rem;\n\t\t\t}\n\t\t\t.permission-modal-header>p{\n\t\t\t\tfont-size: 13px;\n\t\t\t\tmargin-bottom: 2rem;\n\t\t\t}\n\t\t\tbutton.permission-modal-button{\n\t\t\t\tbackground-color: transparent;\n\t\t\t\tborder: 1px solid #fff;\n\t\t\t\tborder-radius: 30px;\n\t\t\t\tfont-weight: 600;\n\t\t\t\tcolor: #fff;\n\t\t\t\tfont-family: 'Poppins', sans-serif;\n\t\t\t\tpadding: 0.5rem 2.5rem;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t\tbutton.permission-modal-button:hover{\n\t\t\t\tbackground-color: #fff;\n\t\t\t\tcolor: #000;\n\t\t\t\ttransition: 0.3s ease-in-out;\n\t\t\t}\n\t\t</style>\n\t\t"}template(){return`\n\t\t\t<div class="permission-modal">\n\t\t\t\t<div class="permission-modal-content">\n\t\t\t\t\t<div class="permission-modal-header">\n\t\t\t\t\t\t<h2 class="permission-modal-title">Microphone blocked</h2>\n\t\t\t\t\t\t<p class="permission-modal-message">${this.attributes.text.value}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="permission-modal-body">\n\t\t\t\t\t\t<button class="permission-modal-button" id="permission-allow">Allow</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}}const n=e;window.customElements.get("check-permissions")||window.customElements.define("check-permissions",n)})();